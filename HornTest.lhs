--------------------------------------------------------------------------------
Author:   Nathan Griffith
Contact:  github.com/smudge
          twitter.com/smudgethefirst
Yale University
CPSC 490 (Senior Project): Spring 2010
--------------------------------------------------------------------------------
HornTest module:
  TEST DATA (a synth french horn)
  extracted FFT data from SPEAR by Michael Klingbeil
  format: [(time, frequency, amplitude)]
  for our purposes, we'll average all frequencies
  TODO: must convert time values to dur values (subtract sum of previous)
--------------------------------------------------------------------------------


> module HornTest where
> import System.IO.Unsafe
> import Control.Arrow (second)
> import Data.List (unfoldr)
> import Control.Monad
> import SoundData
> import SoundDataRender
> import SoundDataCompare
> import SoundDataMutate
> import SoundDataMate

> -- format: time, frequency, amplitude
> h 12 = [0.000000, 1168.635986, 0.000217, 0.012494, 1170.947266, 0.000650, 0.024989, 1172.495972, 0.001266, 0.037483, 1173.933228, 0.001742, 0.049977, 1175.498901, 0.001834, 0.062472, 1177.235718, 0.001635, 0.074966, 1179.085083, 0.001416, 0.087460, 1180.735229, 0.001309, 0.099955, 1181.728638, 0.001282, 0.112449, 1182.132080, 0.001284, 0.124943, 1182.031006, 0.001299, 0.137438, 1181.450317, 0.001320, 0.149932, 1180.384521, 0.001342, 0.162426, 1178.855225, 0.001367, 0.174921, 1176.949097, 0.001395, 0.187415, 1174.774170, 0.001426, 0.199909, 1172.473145, 0.001461, 0.212404, 1170.236816, 0.001502, 0.224898, 1168.275757, 0.001545, 0.237392, 1166.854492, 0.001579, 0.249887, 1166.090210, 0.001589, 0.262381, 1166.126831, 0.001567, 0.274875, 1167.051147, 0.001523, 0.287370, 1168.912109, 0.001471, 0.299864, 1171.696533, 0.001416, 0.312358, 1175.202148, 0.001361, 0.324853, 1179.237305, 0.001314, 0.337347, 1183.432983, 0.001279, 0.349841, 1187.323975, 0.001257, 0.362336, 1190.473755, 0.001245, 0.374830, 1192.489380, 0.001234, 0.387324, 1193.036011, 0.001210, 0.399819, 1191.900024, 0.001163, 0.412313, 1189.082275, 0.001105, 0.424807, 1185.206665, 0.001052, 0.437302, 1181.602905, 0.000969, 0.449796, 1178.724731, 0.000771, 0.462290, 1176.267456, 0.000475, 0.474785, 1173.905640, 0.000203, 0.487279, 1171.052490, 0.000052]
> h 11 = [0.000000, 1039.859497, 0.000447, 0.012494, 1040.831299, 0.001234, 0.024989, 1041.645142, 0.002268, 0.037483, 1042.703247, 0.003032, 0.049977, 1044.194458, 0.003192, 0.062472, 1046.078003, 0.002948, 0.074966, 1048.061035, 0.002708, 0.087460, 1049.660156, 0.002626, 0.099955, 1050.540283, 0.002639, 0.112449, 1050.878540, 0.002685, 0.124943, 1050.771973, 0.002743, 0.137438, 1050.237183, 0.002807, 0.149932, 1049.271606, 0.002871, 0.162426, 1047.902466, 0.002936, 0.174921, 1046.199585, 0.003004, 0.187415, 1044.263306, 0.003079, 0.199909, 1042.220215, 0.003161, 0.212404, 1040.243652, 0.003251, 0.224898, 1038.514160, 0.003346, 0.237392, 1037.241211, 0.003421, 0.249887, 1036.541748, 0.003447, 0.262381, 1036.566650, 0.003410, 0.274875, 1037.400513, 0.003324, 0.287370, 1039.062012, 0.003218, 0.299864, 1041.536865, 0.003102, 0.312358, 1044.664185, 0.002987, 0.324853, 1048.250732, 0.002888, 0.337347, 1051.956909, 0.002814, 0.349841, 1055.403809, 0.002763, 0.362336, 1058.205688, 0.002727, 0.374830, 1060.000244, 0.002692, 0.387324, 1060.487427, 0.002635, 0.399819, 1059.453491, 0.002541, 0.412313, 1056.931641, 0.002427, 0.424807, 1053.496826, 0.002319, 0.437302, 1050.301636, 0.002133, 0.449796, 1047.712646, 0.001698, 0.462290, 1045.477539, 0.001049, 0.474785, 1043.293457, 0.000451, 0.487279, 1040.597534, 0.000115]
> h 10 = [0.000000, 910.343140, 0.000772, 0.012494, 910.868958, 0.001962, 0.024989, 911.362122, 0.003399, 0.037483, 912.101257, 0.004365, 0.049977, 913.331116, 0.004497, 0.062472, 915.045898, 0.004139, 0.074966, 916.918091, 0.003822, 0.087460, 918.396484, 0.003721, 0.099955, 919.197388, 0.003734, 0.112449, 919.512512, 0.003785, 0.124943, 919.422302, 0.003851, 0.137438, 918.960632, 0.003921, 0.149932, 918.118469, 0.003992, 0.162426, 916.917358, 0.004063, 0.174921, 915.442505, 0.004138, 0.187415, 913.746582, 0.004216, 0.199909, 911.955200, 0.004304, 0.212404, 910.237915, 0.004398, 0.224898, 908.717102, 0.004496, 0.237392, 907.595154, 0.004574, 0.249887, 906.969543, 0.004603, 0.262381, 906.982361, 0.004568, 0.274875, 907.716614, 0.004483, 0.287370, 909.177002, 0.004372, 0.299864, 911.367432, 0.004247, 0.312358, 914.103027, 0.004126, 0.324853, 917.243103, 0.004021, 0.337347, 920.482788, 0.003941, 0.349841, 923.484192, 0.003886, 0.362336, 925.931458, 0.003848, 0.374830, 927.494019, 0.003809, 0.387324, 927.911499, 0.003748, 0.399819, 926.990051, 0.003648, 0.412313, 924.762878, 0.003525, 0.424807, 921.741821, 0.003403, 0.437302, 918.888367, 0.003157, 0.449796, 916.547546, 0.002558, 0.462290, 914.484314, 0.001627, 0.474785, 912.551392, 0.000730, 0.487279, 910.637085, 0.000202]
> h 9  = [0.000000, 775.371338, 0.001088, 0.012494, 777.010132, 0.002830, 0.024989, 778.933167, 0.005352, 0.037483, 781.276855, 0.007963, 0.049977, 783.737061, 0.009980, 0.062472, 785.718079, 0.011174, 0.074966, 787.043701, 0.011750, 0.087460, 787.858704, 0.012083, 0.099955, 788.298279, 0.012376, 0.112449, 788.437378, 0.012661, 0.124943, 788.283813, 0.012940, 0.137438, 787.831970, 0.013214, 0.149932, 787.073303, 0.013483, 0.162426, 786.025085, 0.013752, 0.174921, 784.736755, 0.014022, 0.187415, 783.271790, 0.014309, 0.199909, 781.734924, 0.014608, 0.212404, 780.251892, 0.014930, 0.224898, 778.952759, 0.015246, 0.237392, 777.984802, 0.015501, 0.249887, 777.453613, 0.015601, 0.262381, 777.469421, 0.015500, 0.274875, 778.097290, 0.015233, 0.287370, 779.353149, 0.014869, 0.299864, 781.216858, 0.014473, 0.312358, 783.561890, 0.014085, 0.324853, 786.241028, 0.013737, 0.337347, 789.008057, 0.013454, 0.349841, 791.578125, 0.013238, 0.362336, 793.672729, 0.013068, 0.374830, 795.015747, 0.012901, 0.387324, 795.360107, 0.012681, 0.399819, 794.568909, 0.012375, 0.412313, 792.638184, 0.012013, 0.424807, 790.059387, 0.011626, 0.437302, 787.634766, 0.010765, 0.449796, 785.623718, 0.008676, 0.462290, 783.882019, 0.005485, 0.474785, 782.237610, 0.002452, 0.487279, 780.353821, 0.000668, 0.499773, 775.810669, 0.000079]
> h 8  = [0.000000, 642.708130, 0.001442, 0.012494, 645.994629, 0.003945, 0.024989, 649.302246, 0.008139, 0.037483, 652.213501, 0.013246, 0.049977, 654.224609, 0.017658, 0.062472, 655.437683, 0.020267, 0.074966, 656.206543, 0.021409, 0.087460, 656.714294, 0.021983, 0.099955, 657.014099, 0.022475, 0.112449, 657.097107, 0.022961, 0.124943, 656.949707, 0.023445, 0.137438, 656.563599, 0.023931, 0.149932, 655.921204, 0.024411, 0.162426, 655.042175, 0.024898, 0.174921, 653.967224, 0.025400, 0.187415, 652.740479, 0.025906, 0.199909, 651.459229, 0.026454, 0.212404, 650.225098, 0.027012, 0.224898, 649.135864, 0.027568, 0.237392, 648.331543, 0.027997, 0.249887, 647.889954, 0.028155, 0.262381, 647.903748, 0.027972, 0.274875, 648.426147, 0.027508, 0.287370, 649.470154, 0.026887, 0.299864, 651.026550, 0.026214, 0.312358, 652.979858, 0.025546, 0.324853, 655.207642, 0.024934, 0.337347, 657.510071, 0.024413, 0.349841, 659.646423, 0.023979, 0.362336, 661.393311, 0.023608, 0.374830, 662.518494, 0.023260, 0.387324, 662.809204, 0.022849, 0.399819, 662.138306, 0.022337, 0.412313, 660.529053, 0.021767, 0.424807, 658.392151, 0.021097, 0.437302, 656.390076, 0.019476, 0.449796, 654.736145, 0.015637, 0.462290, 653.274658, 0.009869, 0.474785, 651.864319, 0.004403, 0.487279, 650.174988, 0.001214, 0.499773, 646.312622, 0.000146]
> h 7  = [0.000000, 515.808411, 0.002645, 0.012494, 519.782349, 0.008877, 0.024989, 522.013489, 0.020541, 0.037483, 523.318909, 0.034945, 0.049977, 524.133911, 0.046919, 0.062472, 524.700684, 0.053679, 0.074966, 525.128418, 0.056474, 0.087460, 525.450378, 0.057838, 0.099955, 525.659058, 0.059045, 0.112449, 525.708557, 0.060260, 0.124943, 525.581909, 0.061494, 0.137438, 525.270752, 0.062758, 0.149932, 524.751038, 0.064021, 0.162426, 524.042542, 0.065302, 0.174921, 523.184753, 0.066621, 0.187415, 522.198975, 0.067983, 0.199909, 521.174561, 0.069381, 0.212404, 520.188782, 0.070832, 0.224898, 519.312500, 0.072235, 0.237392, 518.671082, 0.073298, 0.249887, 518.316040, 0.073675, 0.262381, 518.327637, 0.073195, 0.274875, 518.747131, 0.072026, 0.287370, 519.579468, 0.070490, 0.299864, 520.831909, 0.068802, 0.312358, 522.389099, 0.067176, 0.324853, 524.165771, 0.065615, 0.337347, 526.008606, 0.064215, 0.349841, 527.714966, 0.062996, 0.362336, 529.111450, 0.061888, 0.374830, 530.015076, 0.060874, 0.387324, 530.248596, 0.059769, 0.399819, 529.705750, 0.058521, 0.412313, 528.419189, 0.057215, 0.424807, 526.706787, 0.055555, 0.437302, 525.104370, 0.051257, 0.449796, 523.767456, 0.041149, 0.462290, 522.566895, 0.025939, 0.474785, 521.478455, 0.011568, 0.487279, 520.536316, 0.003166, 0.499773, 520.859070, 0.000373]
> h 6  = [0.000000, 472.306427, 0.000281, 0.012494, 471.876007, 0.000457, 0.024989, 474.986725, 0.000725, 0.037483, 474.986725, 0.000000]
> h 5  = [0.000000, 441.635529, 0.000449, 0.012494, 439.082275, 0.000794, 0.024989, 438.380920, 0.001463, 0.062472, 423.748169, 0.001955, 0.074966, 429.832336, 0.000436, 0.087460, 429.110535, 0.000196, 0.099955, 429.262756, 0.000218, 0.112449, 438.716248, 0.000182, 0.124943, 428.195831, 0.000229, 0.137438, 428.135498, 0.000230, 0.149932, 427.745605, 0.000228, 0.162426, 427.868652, 0.000210, 0.174921, 428.063080, 0.000226, 0.187415, 436.238495, 0.000194, 0.199909, 435.733307, 0.000203, 0.212404, 426.345428, 0.000262, 0.224898, 426.165955, 0.000217, 0.237392, 434.104187, 0.000286, 0.249887, 424.817535, 0.000453, 0.262381, 433.903290, 0.000294, 0.274875, 426.240723, 0.000296, 0.287370, 425.917480, 0.000301, 0.299864, 435.884918, 0.000213, 0.312358, 437.184052, 0.000205, 0.324853, 437.833252, 0.000187, 0.337347, 439.343964, 0.000188, 0.349841, 440.108643, 0.000174, 0.362336, 440.418335, 0.000172, 0.374830, 441.414825, 0.000158, 0.387324, 441.147003, 0.000194, 0.399819, 450.709717, 0.000131, 0.412313, 450.759125, 0.000145, 0.424807, 454.018188, 0.000213, 0.437302, 424.369232, 0.004562, 0.449796, 424.369232, 0.000000]
> h 4  = [0.000000, 391.336670, 0.011552, 0.012494, 392.020447, 0.034373, 0.024989, 392.494629, 0.071558, 0.037483, 392.894104, 0.112870, 0.049977, 393.252533, 0.144467, 0.062472, 393.583618, 0.161065, 0.074966, 393.873444, 0.167474, 0.087460, 394.102356, 0.170383, 0.099955, 394.251404, 0.172854, 0.112449, 394.286285, 0.175312, 0.124943, 394.192200, 0.177809, 0.137438, 393.959259, 0.180363, 0.149932, 393.570953, 0.182917, 0.162426, 393.041199, 0.185515, 0.174921, 392.394836, 0.188149, 0.187415, 391.657837, 0.190786, 0.199909, 390.891235, 0.193599, 0.212404, 390.147491, 0.196401, 0.224898, 389.491180, 0.199039, 0.237392, 389.007568, 0.201021, 0.249887, 388.738403, 0.201752, 0.262381, 388.747467, 0.200860, 0.274875, 389.065674, 0.198660, 0.287370, 389.692413, 0.195782, 0.299864, 390.631012, 0.192597, 0.312358, 391.803436, 0.189349, 0.324853, 393.136169, 0.186293, 0.337347, 394.514252, 0.183428, 0.349841, 395.793762, 0.180922, 0.362336, 396.839569, 0.178615, 0.374830, 397.511871, 0.176526, 0.387324, 397.683258, 0.174379, 0.399819, 397.269073, 0.172068, 0.412313, 396.299011, 0.169771, 0.424807, 394.978668, 0.166444, 0.437302, 393.696503, 0.155933, 0.449796, 392.568512, 0.128733, 0.462290, 391.533844, 0.084967, 0.474785, 390.524628, 0.040471, 0.487279, 389.489227, 0.012305, 0.499773, 388.210846, 0.001822]
> h 3  = [0.000000, 313.027161, 0.000563, 0.012494, 309.681580, 0.001119, 0.024989, 308.330414, 0.002321, 0.062472, 292.508728, 0.003163, 0.074966, 298.574432, 0.000753, 0.087460, 297.841736, 0.000340, 0.099955, 297.952179, 0.000411, 0.112449, 297.770660, 0.000393, 0.124943, 297.612457, 0.000389, 0.137438, 297.613800, 0.000426, 0.149932, 297.335785, 0.000385, 0.162426, 296.966553, 0.000374, 0.174921, 296.898254, 0.000428, 0.187415, 296.641693, 0.000379, 0.199909, 296.480988, 0.000427, 0.212404, 296.140594, 0.000460, 0.224898, 296.280945, 0.000359, 0.237392, 294.874969, 0.000445, 0.249887, 294.870300, 0.000758, 0.262381, 304.038666, 0.000491, 0.274875, 304.765106, 0.000343, 0.287370, 305.034149, 0.000351, 0.299864, 296.930145, 0.000477, 0.312358, 297.491180, 0.000404, 0.324853, 306.690887, 0.000312, 0.337347, 307.835510, 0.000353, 0.349841, 308.275726, 0.000313, 0.362336, 308.388855, 0.000292, 0.374830, 309.260468, 0.000311, 0.387324, 308.822968, 0.000323, 0.399819, 308.780273, 0.000233, 0.412313, 308.349762, 0.000399, 0.424807, 309.744934, 0.000709, 0.437302, 293.146118, 0.007263, 0.449796, 293.146118, 0.000000]
> h 2  = [0.000000, 260.707153, 0.020255, 0.012494, 261.192841, 0.059757, 0.024989, 261.515076, 0.124268, 0.037483, 261.805359, 0.196193, 0.049977, 262.091370, 0.251428, 0.062472, 262.352692, 0.280582, 0.074966, 262.570129, 0.291972, 0.087460, 262.733429, 0.297202, 0.099955, 262.831024, 0.301603, 0.112449, 262.856232, 0.305959, 0.124943, 262.795013, 0.310356, 0.137438, 262.636932, 0.314815, 0.149932, 262.381256, 0.319324, 0.162426, 262.030212, 0.323989, 0.174921, 261.598236, 0.328719, 0.187415, 261.108826, 0.333495, 0.199909, 260.594025, 0.338318, 0.212404, 260.098450, 0.343108, 0.224898, 259.665039, 0.347606, 0.237392, 259.336212, 0.351083, 0.249887, 259.156860, 0.352312, 0.262381, 259.162933, 0.350784, 0.274875, 259.374359, 0.347062, 0.287370, 259.796844, 0.342196, 0.299864, 260.416046, 0.337037, 0.312358, 261.199310, 0.331744, 0.324853, 262.089935, 0.326457, 0.337347, 263.003754, 0.321502, 0.349841, 263.859131, 0.316874, 0.362336, 264.559021, 0.312530, 0.374830, 265.005737, 0.308491, 0.387324, 265.121399, 0.304646, 0.399819, 264.849121, 0.300975, 0.412313, 264.198364, 0.297429, 0.424807, 263.297760, 0.291898, 0.437302, 262.381378, 0.273358, 0.449796, 261.518188, 0.225613, 0.462290, 260.680847, 0.148873, 0.474785, 259.829254, 0.071251, 0.487279, 258.946106, 0.021632, 0.499773, 257.872803, 0.003248]
> h 1  = [0.000000, 129.592804, 0.016235, 0.012494, 130.187088, 0.038522, 0.024989, 130.475143, 0.067616, 0.037483, 130.660690, 0.094466, 0.049977, 130.856430, 0.112164, 0.062472, 131.059952, 0.120456, 0.074966, 131.234589, 0.123370, 0.087460, 131.351410, 0.124564, 0.099955, 131.401779, 0.125529, 0.112449, 131.422058, 0.126480, 0.124943, 131.395752, 0.127456, 0.137438, 131.313187, 0.128466, 0.149932, 131.194046, 0.129473, 0.162426, 131.018021, 0.130515, 0.174921, 130.800735, 0.131566, 0.187415, 130.565338, 0.132620, 0.199909, 130.302048, 0.133717, 0.212404, 130.055695, 0.134774, 0.224898, 129.839828, 0.135742, 0.237392, 129.663681, 0.136459, 0.249887, 129.576843, 0.136712, 0.262381, 129.578110, 0.136406, 0.274875, 129.679626, 0.135643, 0.287370, 129.898804, 0.134606, 0.299864, 130.202805, 0.133448, 0.312358, 130.591293, 0.132238, 0.324853, 131.041534, 0.131037, 0.337347, 131.493912, 0.129888, 0.349841, 131.924667, 0.128785, 0.362336, 132.278763, 0.127755, 0.374830, 132.499893, 0.126870, 0.387324, 132.565125, 0.126070, 0.399819, 132.428726, 0.125403, 0.412313, 132.098633, 0.124820, 0.424807, 131.590256, 0.123653, 0.437302, 130.960968, 0.118428, 0.449796, 130.306351, 0.102574, 0.462290, 129.637619, 0.073396, 0.474785, 128.884476, 0.039471, 0.487279, 127.853928, 0.014367, 0.499773, 125.301003, 0.002908]
> h 0  = [0.000000, 62.876076, 0.000434, 0.012494, 60.745174, 0.000398, 0.024989, 49.883152, 0.000358, 0.037483, 46.077183, 0.000429, 0.049977, 43.664452, 0.000444, 0.062472, 44.203789, 0.000294, 0.074966, 45.154835, 0.000118, 0.087460, 46.895420, 0.000038, 0.099955, 55.924698, 0.000045, 0.112449, 66.787132, 0.000055, 0.124943, 76.731674, 0.000109, 0.137438, 76.660072, 0.000082, 0.149932, 76.522118, 0.000079, 0.162426, 76.376427, 0.000117, 0.174921, 76.057243, 0.000089, 0.187415, 76.227501, 0.000077, 0.199909, 75.869438, 0.000096, 0.212404, 75.144875, 0.000096, 0.224898, 75.286530, 0.000116, 0.237392, 75.035652, 0.000066, 0.249887, 75.198135, 0.000095, 0.262381, 74.995705, 0.000116, 0.274875, 75.292213, 0.000082, 0.287370, 75.533112, 0.000080, 0.299864, 75.657967, 0.000098, 0.312358, 76.175156, 0.000098, 0.324853, 76.689697, 0.000084, 0.337347, 76.785576, 0.000088, 0.349841, 77.102249, 0.000102, 0.362336, 77.586578, 0.000088, 0.374830, 77.216972, 0.000089, 0.387324, 77.631599, 0.000119, 0.399819, 77.129128, 0.000071, 0.412313, 77.609276, 0.000114, 0.424807, 73.267128, 0.000347, 0.449796, 63.934822, 0.001783, 0.462290, 62.776489, 0.002442, 0.474785, 63.187042, 0.002351]
> h x = []

> hMakeTriples [] = []
> hMakeTriples (x1:x2:x3:xs) = (x1,x2,x3):(hMakeTriples xs)

> hFreqs x = map (\(a, b, c) -> b) (hMakeTriples (h x))
> hTimes x = map (\(a, b, c) -> a) (hMakeTriples (h x))
> hAmpls x = map (\(a, b, c) -> c) (hMakeTriples (h x))

> hFreqsAve x = (foldr (+) 0 fqs) / (fromIntegral (length fqs))
>   where fqs = (hFreqs x)

> hrn x = (sPart (s (hFreqsAve x)) (env (hAmpls x) (tail (hTimes x))))
> hnNormal = map (\x -> (hrn x)) [0..12]

> testHorn = renderSoundN "hornTest.wav" 0.5 hnNormal


-- other test sound

> otherE 0 = (env [0.5,0.75,0.75,0.0] [0.1,2.9,3.0])
> otherE 1 = (env [0.5,1.0,1.0,0.0] [0.1,2.9,3.0])
> otherE 2 = (env [0.25,0.5,0.5,0.0] [0.1,2.9,3.0])
> otherE 3 = (env [0.5,0.25,0.1,0.0] [0.1,2.0,3.0])
> otherS 0 = (sPart (s 440) (otherE 0))
> otherS 1 = (sPart (s 880) (otherE 1))
> otherS 2 = (sPart (s 1320) (otherE 2))
> otherS 3 = (sPart (s 1760) (otherE 3))

> otherArray = map (\x -> (otherS x)) [0..3]

> otherB 0 = (Sine 440 0.75)
> otherB 1 = (Sine 440 1.0)
> otherB 2 = (Sine 440 0.5)
> otherB 3 = (Sine 440 0.1)

> otherBasic = map (\x -> (otherB x)) [0..3]

> testOtherB = renderSoundB "otherTestB.wav" 3.0 otherBasic

> testOther = renderSoundN "otherTest.wav" 3.0 otherArray


-- reading and parsing an input file from SPEAR by Michael Klingbeil

> parseFile x = do
>     list <- getLines x
>     putStr "Parsing file :"
>     let lst = (properData list)
>     --return $ length (toSoundDataComplex lst)
>     renderSoundC "out.wav" 3.0 (toSoundDataComplex lst)
>   where
>     getLines = liftM lines . readFile
>     removeHeaders = tail.tail.tail.tail
>     removeOddElems x = removeOddElems_ x 1
>       where removeOddElems_ [] n = []
>             removeOddElems_ (x:xs) n
>               | (odd n)  = removeOddElems_ xs (n+1)
>               | (even n) = x:(removeOddElems_ xs (n+1))
>     toSoundDataComplex lst = map (\x -> cPart (zip (extractEvery 1 x) (extractEvery 2 x)) (env (extractEvery 3 x) (extractEvery 1 x))) lst
>     extractEvery n a = map head (iterate (drop n) (drop (n-1) a))
>     properData list = (map (map (\x -> (read x::Double))) (map (\x -> split ' ' x) (removeOddElems (removeHeaders  list))))

> line x xs = (!!) xs x

> split delim = takeWhile (not . null) . unfoldr (Just . (second $ drop 1) . break (==delim))
